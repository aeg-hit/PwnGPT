('//----- (08048F8D) --------------------------------------------------------\n'
 'int __cdecl main(int argc, const char **argv, const char **envp)\n'
 '{\n'
 '  int v3; // ecx\n'
 '\n'
 '  LOBYTE(exec_string) = 0;\n'
 '  be_nice_to_people(v3);\n'
 '  return vulnerable_function();\n'
 '}\n'
 '\n'
 '//----- (08048F64) --------------------------------------------------------\n'
 'unsigned int __fastcall be_nice_to_people(int a1)\n'
 '{\n'
 '  int v2; // [esp+8h] [ebp-20h]\n'
 '\n'
 '  v2 = getegid(a1);\n'
 '  return setresgid(v2, v2);\n'
 '}\n'
 '\n'
 '//----- (08048F3B) --------------------------------------------------------\n'
 'int vulnerable_function()\n'
 '{\n'
 '  char v1[136]; // [esp+10h] [ebp-88h] BYREF\n'
 '  int savedregs; // [esp+98h] [ebp+0h] BYREF\n'
 '\n'
 '  return read((int)&savedregs, 0, (int)v1);\n'
 '}\n'
 '\n'
 '//----- (08053BE0) --------------------------------------------------------\n'
 '__int64 __fastcall getegid(int a1)\n'
 '{\n'
 '  return dl_sysinfo(a1);\n'
 '}\n'
 '\n'
 '//----- (08053BF0) --------------------------------------------------------\n'
 'unsigned int __cdecl setresgid(int a1, int a2)\n'
 '{\n'
 '  unsigned int result; // eax\n'
 '\n'
 '  result = dl_sysinfo(a2);\n'
 '  if ( result > 0xFFFFF000 )\n'
 '  {\n'
 '    __writegsdword(0xFFFFFFE8, -result);\n'
 '    return -1;\n'
 '  }\n'
 '  return result;\n'
 '}\n'
 '\n'
 '//----- (08048EF4) --------------------------------------------------------\n'
 'int __cdecl call_me_with_cafebabe(int a1)\n'
 '{\n'
 '  int result; // eax\n'
 '\n'
 '  if ( a1 == -889275714 )\n'
 '  {\n'
 '    result = unk_80C5EC8;\n'
 '    exec_string = unk_80C5EC8;\n'
 '  }\n'
 '  return result;\n'
 '}\n'
 '\n'
 '//----- (08048F0E) --------------------------------------------------------\n'
 'int __cdecl call_me_with_two_args(int a1, int a2)\n'
 '{\n'
 '  int result; // eax\n'
 '\n'
 '  if ( a2 == -889275714 && a1 == -559038737 )\n'
 '  {\n'
 '    strcpy((char *)&exec_string, "/bin");\n'
 '    return (unsigned __int8)aBin[4];\n'
 '  }\n'
 '  return result;\n'
 '}\n'
 '\n')
